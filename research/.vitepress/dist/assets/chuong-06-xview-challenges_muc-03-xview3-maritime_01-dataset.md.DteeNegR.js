import{_ as e}from"./chunks/thumbnails-sar-samples.BKN2bdUm.js";import{_ as l}from"./chunks/vv-vh-comparison.yHqolc0g.js";import{_ as h}from"./chunks/auxiliary-bands.BhsPqWWO.js";import{_ as p}from"./chunks/xview3-scenes-map.BXNoAEfH.js";import{_ as r,C as d,c as k,o as i,a2 as a,b as o,w as n,a as c,G as g,a3 as u}from"./chunks/framework.nRfFlDZQ.js";const E="/sen_doc/assets/sar-teaser.C5IzSrR0.jpg",b="/sen_doc/assets/vessel-length-distribution.Uzyc7-ee.png",y="/sen_doc/assets/scoring-components.5pmgiHVC.png",w=JSON.parse('{"title":"Chương 6: Bộ Dữ Liệu xView3-SAR: Phát Hiện Tàu Thuyền Hàng Hải và Đánh Cá Bất Hợp Pháp","description":"","frontmatter":{},"headers":[],"relativePath":"chuong-06-xview-challenges/muc-03-xview3-maritime/01-dataset.md","filePath":"chuong-06-xview-challenges/muc-03-xview3-maritime/01-dataset.md","lastUpdated":null}'),m={name:"chuong-06-xview-challenges/muc-03-xview3-maritime/01-dataset.md"};function F(v,s,A,C,D,_){const t=d("Mermaid");return i(),k("div",null,[s[1]||(s[1]=a('<h1 id="chuong-6-bo-du-lieu-xview3-sar-phat-hien-tau-thuyen-hang-hai-va-đanh-ca-bat-hop-phap" tabindex="-1">Chương 6: Bộ Dữ Liệu xView3-SAR: Phát Hiện Tàu Thuyền Hàng Hải và Đánh Cá Bất Hợp Pháp <a class="header-anchor" href="#chuong-6-bo-du-lieu-xview3-sar-phat-hien-tau-thuyen-hang-hai-va-đanh-ca-bat-hop-phap" aria-label="Permalink to &quot;Chương 6: Bộ Dữ Liệu xView3-SAR: Phát Hiện Tàu Thuyền Hàng Hải và Đánh Cá Bất Hợp Pháp&quot;">​</a></h1><h2 id="tong-quan" tabindex="-1">Tổng Quan <a class="header-anchor" href="#tong-quan" aria-label="Permalink to &quot;Tổng Quan&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Thuộc tính</th><th>Giá trị</th></tr></thead><tbody><tr><td><strong>Tên chính thức</strong></td><td>xView3-SAR (Synthetic Aperture Radar)</td></tr><tr><td><strong>Năm phát hành</strong></td><td>2021-2022</td></tr><tr><td><strong>Đơn vị tổ chức</strong></td><td>Defense Innovation Unit (DIU), Global Fishing Watch (GFW)</td></tr><tr><td><strong>Nhiệm vụ</strong></td><td>Maritime Detection + Vessel Classification</td></tr><tr><td><strong>Trọng tâm</strong></td><td>Phát hiện &quot;dark fishing&quot; (tàu đánh cá IUU)</td></tr><tr><td><strong>Cuộc thi</strong></td><td>xView3 Challenge</td></tr><tr><td><strong>Giải thưởng</strong></td><td>$150,000 USD</td></tr><tr><td><strong>Số người đăng ký</strong></td><td>1,900 từ 67 quốc gia</td></tr><tr><td><strong>Bài báo</strong></td><td><a href="https://arxiv.org/abs/2206.00897" target="_blank" rel="noreferrer">xView3-SAR: Detecting Dark Fishing Activity (NeurIPS 2022)</a></td></tr><tr><td><strong>GitHub</strong></td><td><a href="https://github.com/DIUx-xView/xview3-reference" target="_blank" rel="noreferrer">DIUx-xView/xview3-reference</a></td></tr></tbody></table><hr><h2 id="_1-gioi-thieu-va-boi-canh" tabindex="-1">1. Giới Thiệu và Bối Cảnh <a class="header-anchor" href="#_1-gioi-thieu-va-boi-canh" aria-label="Permalink to &quot;1. Giới Thiệu và Bối Cảnh&quot;">​</a></h2><h3 id="_1-1-van-nan-đanh-ca-iuu-toan-cau" tabindex="-1">1.1. Vấn Nạn Đánh Cá IUU Toàn Cầu <a class="header-anchor" href="#_1-1-van-nan-đanh-ca-iuu-toan-cau" aria-label="Permalink to &quot;1.1. Vấn Nạn Đánh Cá IUU Toàn Cầu&quot;">​</a></h3><p>Đánh cá bất hợp pháp, không báo cáo và không quản lý (IUU - Illegal, Unreported, and Unregulated fishing) là một trong những thách thức lớn nhất đối với sự bền vững của đại dương. Theo ước tính của FAO và các tổ chức quốc tế, IUU fishing gây thiệt hại từ 10 đến 23 tỷ USD mỗi năm cho nền kinh tế toàn cầu. Nhưng con số này chỉ phản ánh một phần nhỏ của vấn đề - hậu quả thực sự còn bao gồm sự suy kiệt nguồn cá, phá hủy hệ sinh thái biển, đe dọa an ninh lương thực cho hàng triệu người phụ thuộc vào nghề cá, và thường đi kèm với các vi phạm nhân quyền như lao động cưỡng bức.</p><p>Thách thức lớn nhất trong việc chống IUU fishing là phát hiện các &quot;tàu tối&quot; (dark vessels) - những tàu cố tình tắt hệ thống AIS (Automatic Identification System) để tránh bị theo dõi. AIS là hệ thống bắt buộc cho tàu thương mại trên 300 tấn và tàu đánh cá trên 15 mét ở nhiều vùng biển, phát sóng liên tục vị trí, hướng đi, tốc độ và nhận dạng của tàu. Tuy nhiên, các tàu đánh cá bất hợp pháp thường tắt AIS khi hoạt động trong vùng cấm hoặc vượt quá hạn ngạch, khiến việc giám sát bằng phương pháp truyền thống trở nên vô hiệu.</p><h3 id="_1-2-radar-tong-hop-khau-đo-sar-nhu-giai-phap" tabindex="-1">1.2. Radar Tổng Hợp Khẩu Độ (SAR) Như Giải Pháp <a class="header-anchor" href="#_1-2-radar-tong-hop-khau-đo-sar-nhu-giai-phap" aria-label="Permalink to &quot;1.2. Radar Tổng Hợp Khẩu Độ (SAR) Như Giải Pháp&quot;">​</a></h3><p>Synthetic Aperture Radar (SAR) cung cấp khả năng giám sát độc nhất vô nhị cho bài toán phát hiện dark vessels. Khác với ảnh quang học từ các vệ tinh như WorldView hay Pléiades, SAR hoạt động bằng cách phát sóng radar và thu tín hiệu phản hồi, không phụ thuộc vào ánh sáng mặt trời hay điều kiện thời tiết.</p><p><img src="'+E+'" alt="SAR Teaser"><em>SAR imagery demonstrating all-weather detection capabilities</em></p><p><strong>Ưu điểm của SAR so với ảnh quang học:</strong></p><ul><li><strong>Hoạt động 24/7:</strong> Không cần ánh sáng mặt trời, chụp ảnh được cả ban đêm</li><li><strong>Xuyên mây:</strong> Sóng radar C-band có thể xuyên qua mây, sương mù, mưa</li><li><strong>Mọi thời tiết:</strong> Không bị ảnh hưởng bởi điều kiện khí quyển</li><li><strong>Chiếu sáng nhất quán:</strong> Cường độ tín hiệu phản hồi phụ thuộc vào vật liệu và hình dạng, không phụ thuộc góc mặt trời</li></ul><p>Sentinel-1, vệ tinh SAR của European Space Agency (ESA), cung cấp dữ liệu miễn phí với tần suất tái viếng 6 ngày (3 ngày với chùm hai vệ tinh), cho phép giám sát toàn cầu liên tục. Đây là nguồn dữ liệu chính cho xView3-SAR.</p><h3 id="_1-3-su-ra-đoi-cua-xview3" tabindex="-1">1.3. Sự Ra Đời của xView3 <a class="header-anchor" href="#_1-3-su-ra-đoi-cua-xview3" aria-label="Permalink to &quot;1.3. Sự Ra Đời của xView3&quot;">​</a></h3><p>xView3 được khởi xướng vào năm 2021 như sự hợp tác giữa Defense Innovation Unit (DIU) và Global Fishing Watch (GFW). GFW là tổ chức phi lợi nhuận quốc tế chuyên về minh bạch hoạt động đánh cá, sử dụng dữ liệu vệ tinh và machine learning để theo dõi hoạt động của tàu cá trên toàn cầu. Sự hợp tác này kết hợp chuyên môn về AI/ML của DIU với kinh nghiệm domain về nghề cá và dữ liệu AIS của GFW.</p><p>Mục tiêu của xView3 Challenge là phát triển các thuật toán có thể:</p><ol><li>Phát hiện tất cả đối tượng hàng hải (tàu thuyền và cơ sở hạ tầng) từ ảnh SAR</li><li>Phân loại đối tượng là tàu thuyền hay cơ sở hạ tầng cố định</li><li>Xác định tàu nào đang hoạt động đánh cá</li><li>Ước tính chiều dài của tàu</li></ol><p>Đây là bài toán phức tạp hơn đáng kể so với xView1 và xView2: không chỉ phải phát hiện và phân loại object, mà còn phải suy luận về hành vi (đang đánh cá hay không) từ một snapshot duy nhất.</p><h3 id="_1-4-thach-thuc-ky-thuat-đoc-đao" tabindex="-1">1.4. Thách Thức Kỹ Thuật Độc Đáo <a class="header-anchor" href="#_1-4-thach-thuc-ky-thuat-đoc-đao" aria-label="Permalink to &quot;1.4. Thách Thức Kỹ Thuật Độc Đáo&quot;">​</a></h3><p>xView3 đặt ra những thách thức kỹ thuật mà xView1 và xView2 không có:</p><p><strong>1. Dữ liệu SAR thay vì quang học:</strong> SAR imaging tạo ra ảnh grayscale với đặc tính hoàn toàn khác ảnh RGB. Cường độ pixel phản ánh radar backscatter - phụ thuộc vào độ nhám bề mặt, góc tới, và thuộc tính điện từ của vật liệu. Tàu kim loại có backscatter rất mạnh, tạo ra bright spots trên nền biển tối hơn. Tuy nhiên, noise (speckle), sóng biển, và các artifact khác có thể gây false positives.</p><p><strong>2. Kích thước ảnh khổng lồ:</strong> Mỗi scene Sentinel-1 có kích thước trung bình 29,400 × 24,400 pixels, lớn hơn nhiều so với tiles 1024×1024 trong xView1/xView2. Với 991 scenes, tổng số pixel lên tới 1,400 gigapixels - gấp 4.7 lần MS-COCO và lớn hơn 100 lần so với dataset SAR ship detection lớn thứ hai.</p><p><strong>3. Class imbalance cực đoan:</strong> Trong một ảnh 29,400 × 24,400 pixels (≈720 triệu pixels), chỉ có vài chục đến vài trăm pixels thuộc về tàu thuyền. Tỷ lệ object-to-background là khoảng 0.01%, nghĩa là 99.99% pixels là background (biển).</p><p><strong>4. Point labels thay vì bounding boxes:</strong> Không giống xView1 (horizontal bounding boxes) hay xView2 (polygons), xView3 chỉ cung cấp tọa độ điểm trung tâm của mỗi đối tượng. Điều này hạn chế việc sử dụng các object detector truyền thống như Faster R-CNN hay YOLO.</p><p><strong>5. Noisy labels:</strong> Labels được tạo tự động từ việc matching SAR detections với AIS tracks. Các tàu tắt AIS (chính xác là những tàu cần phát hiện) không có ground truth. Dataset training chủ yếu chứa các tàu &quot;sáng&quot; (có AIS), trong khi mục tiêu là phát hiện tàu &quot;tối&quot;.</p><h3 id="_1-5-tac-đong-thuc-tien" tabindex="-1">1.5. Tác Động Thực Tiễn <a class="header-anchor" href="#_1-5-tac-đong-thuc-tien" aria-label="Permalink to &quot;1.5. Tác Động Thực Tiễn&quot;">​</a></h3><p>xView3 không chỉ là bài toán học thuật - các giải pháp chiến thắng đã được Global Fishing Watch tích hợp vào hệ thống giám sát thực tế. Hệ thống có thể quét toàn bộ đại dương được Sentinel-1 cover trong một ngày, phát hiện hàng nghìn tàu và flag những tàu không có tín hiệu AIS tương ứng cho việc điều tra thêm.</p><p>Ứng dụng thực tế bao gồm:</p><ul><li>Hỗ trợ các cơ quan quản lý nghề cá quốc gia giám sát vùng đặc quyền kinh tế</li><li>Phát hiện hoạt động đánh cá bất hợp pháp trong các khu bảo tồn biển</li><li>Theo dõi transshipment (chuyển tải) - hoạt động thường liên quan đến IUU</li><li>Hỗ trợ các tổ chức bảo tồn trong việc bảo vệ biodiversity biển</li></ul><hr><h2 id="_2-thong-so-ky-thuat-va-thong-ke" tabindex="-1">2. Thông Số Kỹ Thuật và Thống Kê <a class="header-anchor" href="#_2-thong-so-ky-thuat-va-thong-ke" aria-label="Permalink to &quot;2. Thông Số Kỹ Thuật và Thống Kê&quot;">​</a></h2><h3 id="_2-1-quy-mo-dataset" tabindex="-1">2.1. Quy Mô Dataset <a class="header-anchor" href="#_2-1-quy-mo-dataset" aria-label="Permalink to &quot;2.1. Quy Mô Dataset&quot;">​</a></h3><p>xView3-SAR là dataset SAR ship detection lớn nhất từng được công bố, vượt xa các benchmark trước đó về mọi thước đo.</p><p><img src="'+e+'" alt="SAR Samples"><em>Sample SAR imagery showing various vessel types and maritime objects</em></p><table tabindex="0"><thead><tr><th>Chỉ số</th><th>Giá trị</th></tr></thead><tbody><tr><td><strong>Tổng số scene SAR</strong></td><td>991 cảnh kích thước đầy đủ</td></tr><tr><td><strong>Kích thước scene trung bình</strong></td><td>29,400 × 24,400 pixels</td></tr><tr><td><strong>Tổng số pixels</strong></td><td>1,400 gigapixels</td></tr><tr><td><strong>Đối tượng hàng hải</strong></td><td>243,018 instances đã xác minh</td></tr><tr><td><strong>Diện tích bao phủ</strong></td><td>43.2 triệu km² (80+ triệu km² tổng)</td></tr><tr><td><strong>Dung lượng dữ liệu</strong></td><td>~1.4 TB</td></tr><tr><td><strong>Số kênh ảnh</strong></td><td>5 (VV, VH, bathymetry, wind_speed, wind_direction)</td></tr></tbody></table><p>Để hiểu rõ hơn về quy mô, 1,400 gigapixels tương đương với 1.4 ngàn tỷ pixels. Nếu mỗi pixel là 1mm², đây sẽ là diện tích 1.4 km² - tương đương một công viên cỡ trung.</p><h3 id="_2-2-so-sanh-voi-cac-dataset-sar-khac" tabindex="-1">2.2. So Sánh Với Các Dataset SAR Khác <a class="header-anchor" href="#_2-2-so-sanh-voi-cac-dataset-sar-khac" aria-label="Permalink to &quot;2.2. So Sánh Với Các Dataset SAR Khác&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Dataset</th><th>Nguồn ảnh</th><th>Số scene</th><th>Gigapixels</th><th>Số đối tượng</th></tr></thead><tbody><tr><td><strong>xView3-SAR</strong></td><td>Sentinel-1</td><td>991</td><td>1,400</td><td>243,018</td></tr><tr><td>OpenSARShip</td><td>Sentinel-1</td><td>11,346 chips</td><td>~12</td><td>17,000</td></tr><tr><td>SSDD</td><td>Sentinel-1, RadarSat-2</td><td>1,160</td><td>~0.5</td><td>2,500</td></tr><tr><td>HRSID</td><td>Sentinel-1, TerraSAR-X</td><td>5,604</td><td>~1.5</td><td>16,951</td></tr><tr><td>SAR-Ship-Dataset</td><td>Gaofen-3, Sentinel-1</td><td>210 images</td><td>~2</td><td>39,729</td></tr><tr><td>LS-SSDD-v1.0</td><td>Sentinel-1</td><td>15</td><td>~5.8</td><td>6,015</td></tr></tbody></table><p><strong>xView3-SAR lớn hơn 100 lần so với dataset SAR ship detection lớn thứ hai về số gigapixels.</strong></p><h3 id="_2-3-phan-chia-du-lieu" tabindex="-1">2.3. Phân Chia Dữ Liệu <a class="header-anchor" href="#_2-3-phan-chia-du-lieu" aria-label="Permalink to &quot;2.3. Phân Chia Dữ Liệu&quot;">​</a></h3><p>Dataset được chia thành bốn tập với các mục đích khác nhau:</p><table tabindex="0"><thead><tr><th>Tập</th><th>Số scene</th><th>Mục đích</th><th>Ghi chú</th></tr></thead><tbody><tr><td><strong>xView3-Train</strong></td><td>~700</td><td>Huấn luyện mô hình</td><td>Labels công khai</td></tr><tr><td><strong>xView3-Validation</strong></td><td>~100</td><td>Điều chỉnh hyperparameters</td><td>Labels công khai</td></tr><tr><td><strong>xView3-Test</strong></td><td>~100</td><td>Leaderboard công khai</td><td>Labels ẩn</td></tr><tr><td><strong>xView3-Holdout</strong></td><td>~90</td><td>Đánh giá cuối cùng</td><td>Labels ẩn</td></tr></tbody></table><p><strong>Lưu ý quan trọng:</strong> Training labels không hoàn chỉnh (incomplete labeling). Do labels được tạo tự động từ AIS, các tàu không phát AIS không có ground truth trong training set. Điều này là thiết kế có chủ đích, phản ánh thực tế của bài toán dark vessel detection.</p><h3 id="_2-4-thong-so-ky-thuat-anh-sar" tabindex="-1">2.4. Thông Số Kỹ Thuật Ảnh SAR <a class="header-anchor" href="#_2-4-thong-so-ky-thuat-anh-sar" aria-label="Permalink to &quot;2.4. Thông Số Kỹ Thuật Ảnh SAR&quot;">​</a></h3><p><strong>Nguồn vệ tinh: Sentinel-1A/B</strong></p><table tabindex="0"><thead><tr><th>Thông số</th><th>Giá trị</th></tr></thead><tbody><tr><td><strong>Đơn vị vận hành</strong></td><td>European Space Agency (ESA)</td></tr><tr><td><strong>Thiết bị</strong></td><td>C-band Synthetic Aperture Radar</td></tr><tr><td><strong>Tần số</strong></td><td>5.405 GHz</td></tr><tr><td><strong>Bước sóng</strong></td><td>~5.6 cm</td></tr><tr><td><strong>Polarization</strong></td><td>VV (Vertical-Vertical) và VH (Vertical-Horizontal)</td></tr><tr><td><strong>Chế độ chụp</strong></td><td>Interferometric Wide (IW) Swath</td></tr><tr><td><strong>Ground sample distance</strong></td><td>10 mét (azimuth) × 10 mét (range)</td></tr><tr><td><strong>Swath width</strong></td><td>250 km</td></tr><tr><td><strong>Thời gian tái viếng</strong></td><td>6 ngày (đơn vệ tinh), 3 ngày (chùm)</td></tr><tr><td><strong>Orbit</strong></td><td>Sun-synchronous, 693 km altitude</td></tr></tbody></table><p><strong>Các kênh được cung cấp:</strong></p><table tabindex="0"><thead><tr><th>Kênh</th><th>File suffix</th><th>Mô tả</th><th>Resolution</th></tr></thead><tbody><tr><td><strong>VV</strong></td><td><code>_vv.tif</code></td><td>Vertical-Vertical polarization (dB)</td><td>10m</td></tr><tr><td><strong>VH</strong></td><td><code>_vh.tif</code></td><td>Vertical-Horizontal polarization (dB)</td><td>10m</td></tr><tr><td><strong>Bathymetry</strong></td><td><code>_bathymetry.tif</code></td><td>Độ sâu nước (mét)</td><td>500m</td></tr><tr><td><strong>Wind Speed</strong></td><td><code>_wind_speed.tif</code></td><td>Tốc độ gió bề mặt (m/s)</td><td>500m</td></tr><tr><td><strong>Wind Direction</strong></td><td><code>_wind_direction.tif</code></td><td>Hướng gió (degrees)</td><td>500m</td></tr></tbody></table><p><strong>Đặc điểm của hai kênh polarization:</strong></p><p><em>VV Polarization (Vertical-Vertical):</em></p><ul><li>Nhạy với bề mặt biển (roughness, sóng)</li><li>Hiển thị wake patterns của tàu</li><li>Có thể phát hiện oil slicks</li><li>Background clutter cao hơn</li></ul><p><em>VH Polarization (Vertical-Horizontal):</em></p><ul><li>Contrast tàu-biển tốt hơn</li><li>Ít background noise hơn</li><li>Tối ưu cho direct vessel detection</li><li>Hiển thị hình dạng tàu rõ hơn</li></ul><p><img src="'+l+'" alt="VV vs VH Comparison"><em>Comparison of VV and VH polarization channels showing different vessel characteristics</em></p><p>Các giải pháp top thường sử dụng cả hai kênh VV và VH, đôi khi tạo composite image hoặc ratio (VV/VH) như kênh thứ ba.</p><h3 id="_2-5-du-lieu-phu-tro" tabindex="-1">2.5. Dữ Liệu Phụ Trợ <a class="header-anchor" href="#_2-5-du-lieu-phu-tro" aria-label="Permalink to &quot;2.5. Dữ Liệu Phụ Trợ&quot;">​</a></h3><p>Ngoài ảnh SAR, xView3 cung cấp các layer dữ liệu phụ trợ quan trọng:</p><p><strong>Bathymetry (độ sâu nước):</strong></p><ul><li>Nguồn: GEBCO (General Bathymetric Chart of the Oceans)</li><li>Hữu ích để phân biệt shallow water artifacts với tàu</li><li>Cơ sở hạ tầng ngoài khơi thường ở vùng nước nông</li></ul><p><strong>Wind Speed và Direction:</strong></p><ul><li>Nguồn: ECMWF reanalysis data</li><li>Ảnh hưởng đến sea state và backscatter</li><li>Gió mạnh tạo sóng, tăng false positive rate</li><li>Có thể dùng để normalize SAR intensity</li></ul><p><strong>Land/Ice Mask:</strong></p><ul><li>Loại bỏ detections trên đất liền hoặc băng</li><li>Post-processing layer quan trọng</li></ul><p><img src="'+h+'" alt="Auxiliary Bands"><em>Visualization of auxiliary data bands: bathymetry, wind speed, and wind direction</em></p><h3 id="_2-6-pham-vi-đia-ly" tabindex="-1">2.6. Phạm Vi Địa Lý <a class="header-anchor" href="#_2-6-pham-vi-đia-ly" aria-label="Permalink to &quot;2.6. Phạm Vi Địa Lý&quot;">​</a></h3><p>Dataset cover các khu vực được chọn lọc chiến lược:</p><p><img src="'+p+`" alt="xView3 Scenes Map"><em>Geographic distribution of xView3 scenes across strategic maritime regions</em></p><table tabindex="0"><thead><tr><th>Khu vực</th><th>Lý do lựa chọn</th></tr></thead><tbody><tr><td><strong>North Sea</strong></td><td>Mật độ giao thông cao, coverage AIS tốt</td></tr><tr><td><strong>Bay of Biscay</strong></td><td>Hoạt động đánh cá châu Âu</td></tr><tr><td><strong>Iceland waters</strong></td><td>Nghề cá vùng nước lạnh, infrastructure</td></tr><tr><td><strong>Adriatic Sea</strong></td><td>Giao thông Địa Trung Hải đa dạng</td></tr><tr><td><strong>West African coast</strong></td><td>Hotspot IUU fishing, dầu khí ngoài khơi</td></tr></tbody></table><p><strong>Tiêu chí lựa chọn khu vực:</strong></p><ol><li>Sentinel-1 coverage thường xuyên (mỗi 3-6 ngày)</li><li>AIS/VMS data availability cao (để tạo ground truth)</li><li>Đa dạng về loại tàu (fishing, cargo, tanker, offshore)</li><li>Liên quan đến IUU (các điểm nóng đánh cá bất hợp pháp)</li><li>Đa dạng về điều kiện biển (wave patterns, wind conditions)</li></ol><hr><h2 id="_3-he-thong-phan-loai-va-annotation" tabindex="-1">3. Hệ Thống Phân Loại và Annotation <a class="header-anchor" href="#_3-he-thong-phan-loai-va-annotation" aria-label="Permalink to &quot;3. Hệ Thống Phân Loại và Annotation&quot;">​</a></h2><h3 id="_3-1-ba-lop-đoi-tuong-chinh" tabindex="-1">3.1. Ba Lớp Đối Tượng Chính <a class="header-anchor" href="#_3-1-ba-lop-đoi-tuong-chinh" aria-label="Permalink to &quot;3.1. Ba Lớp Đối Tượng Chính&quot;">​</a></h3><p>xView3 phân loại đối tượng hàng hải thành ba lớp dựa trên chức năng và hành vi:</p><table tabindex="0"><thead><tr><th>Lớp</th><th>Mô tả</th><th>Đặc điểm SAR</th></tr></thead><tbody><tr><td><strong>Vessel</strong></td><td>Tàu và thuyền không đánh cá</td><td>Point target sáng, có thể có wake</td></tr><tr><td><strong>Fishing Vessel</strong></td><td>Tàu đang hoạt động đánh cá</td><td>Thường nhỏ hơn, có fishing gear signature</td></tr><tr><td><strong>Fixed Infrastructure</strong></td><td>Giàn khoan, platform, phao</td><td>Rất sáng, không di chuyển, thường lớn</td></tr></tbody></table><p><strong>Phân bố lớp trong dataset:</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Vessels (non-fishing):  ████████████████████████████████████  60%</span></span>
<span class="line"><span>Fishing Vessels:        ██████████████████████                35%</span></span>
<span class="line"><span>Fixed Infrastructure:   █████                                   5%</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="`+b+`" alt="Vessel Length Distribution"><em>Distribution of vessel lengths in the xView3 dataset</em></p><h3 id="_3-2-thuoc-tinh-nhan-chi-tiet" tabindex="-1">3.2. Thuộc Tính Nhãn Chi Tiết <a class="header-anchor" href="#_3-2-thuoc-tinh-nhan-chi-tiet" aria-label="Permalink to &quot;3.2. Thuộc Tính Nhãn Chi Tiết&quot;">​</a></h3><p>Mỗi đối tượng được annotate với các thuộc tính sau:</p><table tabindex="0"><thead><tr><th>Thuộc tính</th><th>Kiểu dữ liệu</th><th>Giá trị</th><th>Mô tả</th></tr></thead><tbody><tr><td><code>scene_id</code></td><td>String</td><td>scene_XXXX</td><td>ID của scene SAR</td></tr><tr><td><code>detect_lon</code></td><td>Float</td><td>-180 to 180</td><td>Kinh độ (WGS84)</td></tr><tr><td><code>detect_lat</code></td><td>Float</td><td>-90 to 90</td><td>Vĩ độ (WGS84)</td></tr><tr><td><code>is_vessel</code></td><td>Boolean</td><td>True/False</td><td>Tàu thuyền hay infrastructure</td></tr><tr><td><code>is_fishing</code></td><td>Boolean</td><td>True/False/None</td><td>Có đang đánh cá không</td></tr><tr><td><code>vessel_length_m</code></td><td>Float</td><td>5-400+</td><td>Chiều dài ước tính (mét)</td></tr><tr><td><code>confidence</code></td><td>Categorical</td><td>HIGH/MEDIUM/LOW</td><td>Mức độ tin cậy của annotation</td></tr></tbody></table><p><strong>Lưu ý về <code>is_fishing</code>:</strong></p><ul><li><code>True</code>: Xác định là tàu đánh cá đang hoạt động</li><li><code>False</code>: Xác định là tàu KHÔNG đánh cá (cargo, tanker, etc.)</li><li><code>None/NaN</code>: Không xác định được (missing label)</li></ul><h3 id="_3-3-nguon-goc-ground-truth" tabindex="-1">3.3. Nguồn Gốc Ground Truth <a class="header-anchor" href="#_3-3-nguon-goc-ground-truth" aria-label="Permalink to &quot;3.3. Nguồn Gốc Ground Truth&quot;">​</a></h3><p>Ground truth trong xView3 được tạo từ nhiều nguồn kết hợp:</p><p><strong>1. AIS (Automatic Identification System):</strong></p><ul><li>Hệ thống phát vị trí bắt buộc cho tàu thương mại lớn</li><li>Cung cấp: MMSI, tên tàu, loại tàu, chiều dài, destination</li><li>Matching với SAR detection theo thời gian và vị trí</li><li>~80% labels đến từ nguồn này</li></ul><p><strong>2. VMS (Vessel Monitoring System):</strong></p><ul><li>Hệ thống giám sát bắt buộc cho tàu đánh cá ở nhiều quốc gia</li><li>Tương tự AIS nhưng chuyên cho fishing vessels</li><li>Cung cấp thông tin về fishing effort</li></ul><p><strong>3. Manual Annotation:</strong></p><ul><li>Cho các đối tượng không có AIS/VMS match</li><li>Thực hiện bởi domain experts</li><li>Assigned confidence level (HIGH/MEDIUM/LOW)</li></ul><p><strong>4. CFAR Detection:</strong></p><ul><li>Constant False Alarm Rate - thuật toán phát hiện tự động</li><li>Dùng để tìm candidate objects</li><li>Được refine bởi các nguồn khác</li></ul><h3 id="_3-4-quy-trinh-matching-ais-sar" tabindex="-1">3.4. Quy Trình Matching AIS-SAR <a class="header-anchor" href="#_3-4-quy-trinh-matching-ais-sar" aria-label="Permalink to &quot;3.4. Quy Trình Matching AIS-SAR&quot;">​</a></h3><p>Việc match AIS tracks với SAR detections là bước phức tạp nhất trong pipeline annotation:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SAR Image Acquisition Time: T₀</span></span>
<span class="line"><span>AIS Position at T₀: (lon_ais, lat_ais)</span></span>
<span class="line"><span>SAR Detection at: (x_det, y_det) → (lon_det, lat_det)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Match Criteria:</span></span>
<span class="line"><span>1. Temporal: |T_ais - T₀| &lt; 10 minutes</span></span>
<span class="line"><span>2. Spatial: distance(ais, detection) &lt; 200 meters</span></span>
<span class="line"><span>3. Speed consistency: Predicted position matches detection</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>Các thách thức:</strong></p><ul><li>AIS position có thể bị delay so với SAR acquisition</li><li>Interpolation cần thiết cho positions giữa hai AIS pings</li><li>Multi-path matching khi nhiều tàu gần nhau</li><li>Spoofing: Một số tàu giả mạo vị trí AIS</li></ul><h3 id="_3-5-confidence-levels" tabindex="-1">3.5. Confidence Levels <a class="header-anchor" href="#_3-5-confidence-levels" aria-label="Permalink to &quot;3.5. Confidence Levels&quot;">​</a></h3><p>Mức độ tin cậy phản ánh quality của annotation:</p><p><strong>HIGH Confidence:</strong></p><ul><li>AIS match với correlation &gt; 95%</li><li>Hoặc manual annotation bởi expert với certainty cao</li><li>Sử dụng cho evaluation metrics</li></ul><p><strong>MEDIUM Confidence:</strong></p><ul><li>AIS match với correlation 80-95%</li><li>Hoặc manual annotation với some uncertainty</li><li>Có thể dùng cho training</li></ul><p><strong>LOW Confidence:</strong></p><ul><li>Weak AIS correlation hoặc inference-based</li><li>Có thể là false positive</li><li>Cần xử lý cẩn thận trong training</li></ul><h3 id="_3-6-đinh-dang-du-lieu" tabindex="-1">3.6. Định Dạng Dữ Liệu <a class="header-anchor" href="#_3-6-đinh-dang-du-lieu" aria-label="Permalink to &quot;3.6. Định Dạng Dữ Liệu&quot;">​</a></h3><p><strong>Cấu trúc thư mục:</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>xview3/</span></span>
<span class="line"><span>├── train/</span></span>
<span class="line"><span>│   ├── images/</span></span>
<span class="line"><span>│   │   ├── scene_0001_vh.tif</span></span>
<span class="line"><span>│   │   ├── scene_0001_vv.tif</span></span>
<span class="line"><span>│   │   ├── scene_0001_bathymetry.tif</span></span>
<span class="line"><span>│   │   ├── scene_0001_wind_speed.tif</span></span>
<span class="line"><span>│   │   ├── scene_0001_wind_direction.tif</span></span>
<span class="line"><span>│   │   └── ...</span></span>
<span class="line"><span>│   └── labels/</span></span>
<span class="line"><span>│       └── train_labels.csv</span></span>
<span class="line"><span>├── validation/</span></span>
<span class="line"><span>│   ├── images/</span></span>
<span class="line"><span>│   └── labels/</span></span>
<span class="line"><span>│       └── validation_labels.csv</span></span>
<span class="line"><span>└── test/</span></span>
<span class="line"><span>    └── images/  # No labels provided</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><strong>Format CSV labels:</strong></p><div class="language-csv vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">csv</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scene_id,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">detect_lon,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">detect_lat,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">is_vessel,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">is_fishing,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">vessel_length_m,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">confidence</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scene_0001,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">12.34567,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">56.78901,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">True,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">True,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">25.5,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">HIGH</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scene_0001,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">12.35000,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">56.79500,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">True,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">False,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">150.0,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MEDIUM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scene_0001,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">12.36000,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">56.80000,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">False,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">HIGH</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scene_0002,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">3.45678,</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">45.67890,</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">True,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">45.0,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">LOW</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>Lưu ý về missing values:</strong></p><ul><li><code>is_fishing</code> có thể là blank khi không xác định được</li><li><code>vessel_length_m</code> có thể missing cho infrastructure</li><li>Cần xử lý NaN properly trong code</li></ul><hr><h2 id="_4-quy-trinh-tao-dataset" tabindex="-1">4. Quy Trình Tạo Dataset <a class="header-anchor" href="#_4-quy-trinh-tao-dataset" aria-label="Permalink to &quot;4. Quy Trình Tạo Dataset&quot;">​</a></h2><h3 id="_4-1-pipeline-tong-quan" tabindex="-1">4.1. Pipeline Tổng Quan <a class="header-anchor" href="#_4-1-pipeline-tong-quan" aria-label="Permalink to &quot;4.1. Pipeline Tổng Quan&quot;">​</a></h3><p>Việc tạo xView3-SAR là quy trình phức tạp với 9 bước chính, kết hợp automated processing và expert validation:</p>`,118)),(i(),o(u,null,{default:n(()=>[g(t,{id:"mermaid-1393",class:"mermaid",graph:"flowchart%20TB%0A%20%20%20%20subgraph%20Phase1%5BData%20Acquisition%5D%0A%20%20%20%20%20%20%20%20A1%5BL%E1%BB%B1a%20ch%E1%BB%8Dn%3Cbr%2F%3Ekhu%20v%E1%BB%B1c%20%C4%91%E1%BB%8Ba%20l%C3%BD%5D%20--%3E%20A2%5BDownload%3Cbr%2F%3ESentinel-1%20scenes%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20Phase2%5BProcessing%5D%0A%20%20%20%20%20%20%20%20B1%5BSAR%20preprocessing%3Cbr%2F%3ESNAP%20Toolbox%5D%20--%3E%20B2%5BAncillary%20data%3Cbr%2F%3Eprocessing%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20Phase3%5BDetection%5D%0A%20%20%20%20%20%20%20%20C1%5BCFAR%20automated%3Cbr%2F%3Edetection%5D%20--%3E%20C2%5BAIS%2FVMS%3Cbr%2F%3Ecorrelation%5D%0A%20%20%20%20end%0A%0A%20%20%20%20subgraph%20Phase4%5BAnnotation%5D%0A%20%20%20%20%20%20%20%20D1%5BVessel%3Cbr%2F%3Eclassification%5D%20--%3E%20D2%5BManual%20labeling%3Cbr%2F%3Efor%20unmatched%5D%20--%3E%20D3%5BQuality%20control%3Cbr%2F%3E%26%20merging%5D%0A%20%20%20%20end%0A%0A%20%20%20%20Phase1%20--%3E%20Phase2%20--%3E%20Phase3%20--%3E%20Phase4%0A"})]),fallback:n(()=>[...s[0]||(s[0]=[c(" Loading... ",-1)])]),_:1})),s[2]||(s[2]=a(`<h3 id="_4-2-buoc-1-2-lua-chon-khu-vuc-va-download-du-lieu" tabindex="-1">4.2. Bước 1-2: Lựa Chọn Khu Vực và Download Dữ Liệu <a class="header-anchor" href="#_4-2-buoc-1-2-lua-chon-khu-vuc-va-download-du-lieu" aria-label="Permalink to &quot;4.2. Bước 1-2: Lựa Chọn Khu Vực và Download Dữ Liệu&quot;">​</a></h3><p><strong>Tiêu chí lựa chọn khu vực:</strong></p><p>Các nhà nghiên cứu đã lựa chọn khu vực dựa trên nhiều yếu tố:</p><ul><li><strong>Sentinel-1 revisit:</strong> Ưu tiên vùng có coverage thường xuyên</li><li><strong>AIS density:</strong> Vùng có nhiều tàu phát AIS để tạo ground truth</li><li><strong>Maritime diversity:</strong> Đa dạng về loại tàu và hoạt động</li><li><strong>IUU relevance:</strong> Các điểm nóng đánh cá bất hợp pháp đã biết</li><li><strong>Sea state variety:</strong> Đa dạng điều kiện biển (calm, rough, etc.)</li></ul><p><strong>Download Sentinel-1:</strong></p><p>Sentinel-1 data được download từ Copernicus Open Access Hub (nay là Copernicus Data Space Ecosystem):</p><ul><li>Product type: GRD (Ground Range Detected)</li><li>Mode: IW (Interferometric Wide swath)</li><li>Resolution: 10m</li><li>Polarization: VV+VH (dual pol)</li></ul><h3 id="_4-3-buoc-3-4-sar-preprocessing" tabindex="-1">4.3. Bước 3-4: SAR Preprocessing <a class="header-anchor" href="#_4-3-buoc-3-4-sar-preprocessing" aria-label="Permalink to &quot;4.3. Bước 3-4: SAR Preprocessing&quot;">​</a></h3><p>Dữ liệu SAR thô cần qua nhiều bước xử lý trước khi sử dụng:</p><p><strong>Công cụ sử dụng:</strong></p><ul><li>ESA SNAP Toolbox (Sentinel Application Platform)</li><li>GDAL/OGR library</li><li>Custom Python scripts</li></ul><p><strong>Pipeline xử lý:</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Conceptual preprocessing pipeline</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> preprocess_sentinel1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(input_safe):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 1. Apply orbit file correction</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    scene </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> apply_orbit_file(input_safe)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 2. Remove thermal noise</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    scene </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> thermal_noise_removal(scene)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 3. Radiometric calibration (to sigma0)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    scene </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> calibration(scene, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">output</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;sigma0&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 4. Terrain correction (geocoding)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    scene </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> terrain_correction(scene, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">dem</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;SRTM_3Sec&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 5. Convert to dB scale</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    scene </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> linear_to_db(scene)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 6. Export as GeoTIFF</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    export_geotiff(scene, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;output.tif&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scene</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><strong>Các bước chi tiết:</strong></p><ol><li><strong>Orbit file correction:</strong> Apply precise orbit data để cải thiện geolocation accuracy</li><li><strong>Thermal noise removal:</strong> Loại bỏ nhiễu nhiệt từ antenna system</li><li><strong>Radiometric calibration:</strong> Chuyển digital numbers sang radar cross-section (sigma0)</li><li><strong>Terrain correction:</strong> Orthorectification và geocoding theo DEM</li><li><strong>dB conversion:</strong> Chuyển từ linear scale sang decibel để dễ visualize và process</li></ol><h3 id="_4-4-buoc-5-cfar-detection" tabindex="-1">4.4. Bước 5: CFAR Detection <a class="header-anchor" href="#_4-4-buoc-5-cfar-detection" aria-label="Permalink to &quot;4.4. Bước 5: CFAR Detection&quot;">​</a></h3><p>Constant False Alarm Rate (CFAR) là thuật toán phát hiện tự động được sử dụng rộng rãi trong SAR:</p><p><strong>Nguyên lý hoạt động:</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Cho mỗi pixel (target cell):</span></span>
<span class="line"><span>1. Định nghĩa guard cells xung quanh target</span></span>
<span class="line"><span>2. Định nghĩa training cells xung quanh guard region</span></span>
<span class="line"><span>3. Estimate background statistics từ training cells</span></span>
<span class="line"><span>4. Set threshold = background_mean + k × background_std</span></span>
<span class="line"><span>5. Nếu target &gt; threshold → Detection</span></span>
<span class="line"><span>6. k được chọn để đạt desired false alarm rate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>Các variant CFAR:</strong></p><ul><li><strong>CA-CFAR:</strong> Cell Averaging - mean của training cells</li><li><strong>GO-CFAR:</strong> Greatest Of - max của hai halves</li><li><strong>SO-CFAR:</strong> Smallest Of - min của hai halves</li><li><strong>OS-CFAR:</strong> Order Statistics - sử dụng ordered values</li></ul><p>xView3 sử dụng combination of CFAR variants để maximize recall trong khi maintain manageable false positive rate.</p><h3 id="_4-5-buoc-6-ais-vms-correlation" tabindex="-1">4.5. Bước 6: AIS/VMS Correlation <a class="header-anchor" href="#_4-5-buoc-6-ais-vms-correlation" aria-label="Permalink to &quot;4.5. Bước 6: AIS/VMS Correlation&quot;">​</a></h3><p>Đây là bước quan trọng nhất để tạo ground truth labels:</p><p><strong>Dữ liệu AIS:</strong></p><ul><li>Historical AIS messages từ Spire, ORBCOMM, hoặc terrestrial stations</li><li>Mỗi message chứa: MMSI, timestamp, position, speed, course, ship type</li><li>Interpolate positions để match với SAR acquisition time</li></ul><p><strong>Matching algorithm:</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> match_ais_to_detection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sar_time, detection_coords, ais_tracks):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    matches </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> track </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ais_tracks:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # Interpolate AIS position to SAR acquisition time</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ais_pos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> interpolate_position(track, sar_time)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # Calculate distance</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> geodesic_distance(detection_coords, ais_pos)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # Check speed consistency</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        expected_pos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> predict_position(track, sar_time)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        speed_check </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> is_consistent(detection_coords, expected_pos)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> speed_check:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            matches.append({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &#39;mmsi&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: track.mmsi,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &#39;ship_type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: track.ship_type,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &#39;length&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: track.length,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &#39;confidence&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: calculate_confidence(dist, speed_check)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> best_match(matches)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="_4-6-buoc-7-vessel-classification" tabindex="-1">4.6. Bước 7: Vessel Classification <a class="header-anchor" href="#_4-6-buoc-7-vessel-classification" aria-label="Permalink to &quot;4.6. Bước 7: Vessel Classification&quot;">​</a></h3><p>Sử dụng AIS ship type để classify vessels:</p><table tabindex="0"><thead><tr><th>AIS Ship Type Code</th><th>Classification</th></tr></thead><tbody><tr><td>30-39</td><td>Fishing Vessel</td></tr><tr><td>60-69</td><td>Passenger</td></tr><tr><td>70-79</td><td>Cargo</td></tr><tr><td>80-89</td><td>Tanker</td></tr><tr><td>0, 90-99</td><td>Other</td></tr></tbody></table><p><strong>is_fishing determination:</strong></p><ul><li>Ship type 30-39 → <code>is_fishing = True</code></li><li>Other ship types → <code>is_fishing = False</code></li><li>Unknown type → <code>is_fishing = None</code></li></ul><h3 id="_4-7-buoc-8-manual-annotation" tabindex="-1">4.7. Bước 8: Manual Annotation <a class="header-anchor" href="#_4-7-buoc-8-manual-annotation" aria-label="Permalink to &quot;4.7. Bước 8: Manual Annotation&quot;">​</a></h3><p>Đối với detections không có AIS match (potential dark vessels):</p><p><strong>Workflow:</strong></p><ol><li>Expert reviewer xem ảnh SAR gốc</li><li>Assess signal characteristics (size, shape, brightness)</li><li>Assign <code>is_vessel</code> based on appearance</li><li>Assign confidence level (HIGH/MEDIUM/LOW)</li><li>Cannot determine <code>is_fishing</code> → leave as None</li></ol><p><strong>Criteria cho manual labels:</strong></p><ul><li><strong>Vessel:</strong> Compact bright target, possibly with wake</li><li><strong>Infrastructure:</strong> Very bright, large, stationary (check with multiple scenes)</li><li><strong>Artifact:</strong> Bright spot at edge, azimuth ambiguity pattern</li></ul><h3 id="_4-8-buoc-9-quality-assurance" tabindex="-1">4.8. Bước 9: Quality Assurance <a class="header-anchor" href="#_4-8-buoc-9-quality-assurance" aria-label="Permalink to &quot;4.8. Bước 9: Quality Assurance&quot;">​</a></h3><p><strong>Multi-level QA:</strong></p><ol><li><p><strong>Automated checks:</strong></p><ul><li>Spatial consistency (detections on land?)</li><li>Duplicate detection removal</li><li>Metadata validation</li></ul></li><li><p><strong>Cross-validation:</strong></p><ul><li>Compare CFAR detections với AIS-only</li><li>Check for missing high-confidence vessels</li><li>Validate infrastructure labels với known databases</li></ul></li><li><p><strong>Expert review:</strong></p><ul><li>Sample-based review của random scenes</li><li>Edge case analysis</li><li>Consistency across annotators</li></ul></li></ol><p><strong>Final merging:</strong></p><ul><li>Combine automated và manual annotations</li><li>Resolve conflicts (multiple annotations for same target)</li><li>Generate final CSV labels</li></ul><hr><h2 id="_5-thach-thuc-computer-vision" tabindex="-1">5. Thách Thức Computer Vision <a class="header-anchor" href="#_5-thach-thuc-computer-vision" aria-label="Permalink to &quot;5. Thách Thức Computer Vision&quot;">​</a></h2><h3 id="_5-1-bai-toan-multi-task-detection-va-classification" tabindex="-1">5.1. Bài Toán Multi-Task Detection và Classification <a class="header-anchor" href="#_5-1-bai-toan-multi-task-detection-va-classification" aria-label="Permalink to &quot;5.1. Bài Toán Multi-Task Detection và Classification&quot;">​</a></h3><p>xView3 Challenge yêu cầu giải quyết bốn sub-tasks đồng thời:</p><table tabindex="0"><thead><tr><th>Task</th><th>Input</th><th>Output</th><th>Metric</th></tr></thead><tbody><tr><td><strong>Detection</strong></td><td>SAR scene</td><td>List of (x, y) coordinates</td><td>F1 @ 200m</td></tr><tr><td><strong>is_vessel</strong></td><td>Detected objects</td><td>Boolean classification</td><td>F1 score</td></tr><tr><td><strong>is_fishing</strong></td><td>Vessel objects</td><td>Boolean classification</td><td>F1 score</td></tr><tr><td><strong>vessel_length</strong></td><td>Vessel objects</td><td>Length in meters</td><td>Mean Absolute Error</td></tr></tbody></table><p><strong>Scoring formula:</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Overall Score = 0.5 × Detection_F1</span></span>
<span class="line"><span>              + 0.2 × Vessel_Classification_F1</span></span>
<span class="line"><span>              + 0.2 × Fishing_Classification_F1</span></span>
<span class="line"><span>              + 0.1 × (1 - Length_Error_Normalized)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_5-2-extreme-class-imbalance" tabindex="-1">5.2. Extreme Class Imbalance <a class="header-anchor" href="#_5-2-extreme-class-imbalance" aria-label="Permalink to &quot;5.2. Extreme Class Imbalance&quot;">​</a></h3><p>Đây có lẽ là thách thức lớn nhất của xView3:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Background (sea):     ████████████████████████████████████████  99.99%</span></span>
<span class="line"><span>Objects (vessels):    █                                         0.01%</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>Con số cụ thể:</strong></p><ul><li>Scene size: ~720 million pixels (29,400 × 24,400)</li><li>Objects per scene: 50-500 (average ~250)</li><li>Object-to-background ratio: ~1:2,880,000</li></ul><p><strong>Chiến lược xử lý:</strong></p><ol><li><p><strong>Tiling with oversampling:</strong></p><ul><li>Chia scene thành tiles (512×512 hoặc 2048×2048)</li><li>Oversample tiles chứa objects</li><li>Discard tiles hoàn toàn background</li></ul></li><li><p><strong>Hard negative mining:</strong></p><ul><li>Thu thập false positives từ previous iterations</li><li>Include chúng trong training để reduce false alarms</li></ul></li><li><p><strong>Focal loss variants:</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Reduced Focal Loss (từ xView1, adapted cho xView3)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> reduced_focal_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pred, target, alpha</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, gamma</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bce </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> F.binary_cross_entropy_with_logits(pred, target, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">reduction</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;none&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    pt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch.where(target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, pred.sigmoid(), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pred.sigmoid())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    focal_weight </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pt) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gamma</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Reduce loss for easy negative samples</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reduce_factor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> torch.where(target </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, alpha </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (pt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1e-8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (focal_weight </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reduce_factor </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bce).mean()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li><li><p><strong>Detection as segmentation:</strong></p><ul><li>Thay vì bounding box detection, predict center heatmap</li><li>CircleNet approach của giải pháp hạng 1</li></ul></li></ol><h3 id="_5-3-point-based-annotation-challenge" tabindex="-1">5.3. Point-Based Annotation Challenge <a class="header-anchor" href="#_5-3-point-based-annotation-challenge" aria-label="Permalink to &quot;5.3. Point-Based Annotation Challenge&quot;">​</a></h3><p>Không có bounding box hay segmentation mask, chỉ có point labels.</p><p><strong>Vấn đề:</strong></p><ul><li>Không biết kích thước của object</li><li>Không thể dùng standard object detector loss (IoU-based)</li><li>Khó train regression cho vessel length</li></ul><p><strong>Giải pháp: Keypoint Detection / Heatmap</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> create_heatmap_target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(points, image_size, sigma</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Tạo Gaussian heatmap target từ point annotations</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    heatmap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.zeros(image_size)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x, y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> points:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # Create Gaussian kernel centered at point</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        xx, yy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.meshgrid(np.arange(image_size[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                             np.arange(image_size[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        gaussian </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.exp(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((xx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (yy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sigma</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        heatmap </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.maximum(heatmap, gaussian)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> heatmap</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_5-4-noisy-va-incomplete-labels" tabindex="-1">5.4. Noisy và Incomplete Labels <a class="header-anchor" href="#_5-4-noisy-va-incomplete-labels" aria-label="Permalink to &quot;5.4. Noisy và Incomplete Labels&quot;">​</a></h3><p>Training labels không đầy đủ - đây là feature, không phải bug:</p><p><strong>Vấn đề:</strong></p><ul><li>Dark vessels không có AIS match → không có label</li><li>Một số labels có thể bị miss</li><li>Một số labels có thể là false positives</li></ul><p><strong>Chiến lược:</strong></p><ol><li><p><strong>Positive-Unlabeled Learning:</strong></p><ul><li>Treat unlabeled detections as &quot;unknown&quot; không phải &quot;negative&quot;</li><li>Modify loss function để không penalize unlabeled regions</li></ul></li><li><p><strong>Self-training / Pseudo-labeling:</strong></p><ul><li>Train initial model với available labels</li><li>Use model predictions để generate pseudo-labels</li><li>Retrain với combined labels</li></ul></li><li><p><strong>Confidence-weighted loss:</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> confidence_weighted_loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pred, target, confidence):</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # HIGH = 1.0, MEDIUM = 0.7, LOW = 0.4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    weight </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;HIGH&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;MEDIUM&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;LOW&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}[confidence]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> weight </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> criterion(pred, target)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ol><h3 id="_5-5-sar-specific-challenges" tabindex="-1">5.5. SAR-Specific Challenges <a class="header-anchor" href="#_5-5-sar-specific-challenges" aria-label="Permalink to &quot;5.5. SAR-Specific Challenges&quot;">​</a></h3><p><strong>Speckle Noise:</strong> SAR images có granular noise đặc trưng gọi là speckle, do coherent interference của scattered signals:</p><ul><li>Làm giảm SNR</li><li>Có thể tạo false positives</li><li>Cần speckle filtering hoặc multi-looking</li></ul><p><strong>Sea State Variation:</strong></p><ul><li>Rough sea (gió mạnh) → high backscatter background → harder detection</li><li>Calm sea → low background → easier detection but rare</li><li>Wind speed data có thể dùng để normalize</li></ul><p><strong>Azimuth Ambiguities:</strong> SAR processing có thể tạo ghost images của bright targets, displaced trong azimuth direction. Cần post-processing để remove.</p><h3 id="_5-6-multi-scale-detection" tabindex="-1">5.6. Multi-Scale Detection <a class="header-anchor" href="#_5-6-multi-scale-detection" aria-label="Permalink to &quot;5.6. Multi-Scale Detection&quot;">​</a></h3><p>Vessels có kích thước rất đa dạng:</p><table tabindex="0"><thead><tr><th>Loại tàu</th><th>Chiều dài</th><th>SAR pixels (10m GSD)</th></tr></thead><tbody><tr><td>Small fishing boat</td><td>5-15m</td><td>1-2 pixels</td></tr><tr><td>Medium fishing vessel</td><td>15-50m</td><td>2-5 pixels</td></tr><tr><td>Cargo ship</td><td>100-300m</td><td>10-30 pixels</td></tr><tr><td>Supertanker</td><td>300-400m</td><td>30-40 pixels</td></tr><tr><td>Offshore platform</td><td>50-200m</td><td>5-20 pixels</td></tr></tbody></table><p><strong>Giải pháp:</strong></p><ul><li>Feature Pyramid Networks (FPN)</li><li>Multi-scale input processing</li><li>Anchor-free detection (CenterNet, CircleNet)</li></ul><h3 id="_5-7-baseline-model-va-top-solutions" tabindex="-1">5.7. Baseline Model và Top Solutions <a class="header-anchor" href="#_5-7-baseline-model-va-top-solutions" aria-label="Permalink to &quot;5.7. Baseline Model và Top Solutions&quot;">​</a></h3><p><strong>Official Baseline:</strong></p><ul><li>Architecture: U-Net với ResNet encoder</li><li>Detection via semantic segmentation</li><li>Post-processing để extract point coordinates</li></ul><p><strong>Giải pháp Hạng 1 (CircleNet by bloodaxe):</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Key innovations:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. CircleNet: Predict center + radius instead of bbox</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. Reduced Focal Loss from xView1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. Multi-channel input (VV, VH, bathymetry, wind)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. Heavy augmentation with careful geometry handling</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. Ensemble of multiple backbones</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Performance improvements: 3× better than baseline.</p><hr><h2 id="_6-huong-dan-su-dung-va-tai-nguyen" tabindex="-1">6. Hướng Dẫn Sử Dụng và Tài Nguyên <a class="header-anchor" href="#_6-huong-dan-su-dung-va-tai-nguyen" aria-label="Permalink to &quot;6. Hướng Dẫn Sử Dụng và Tài Nguyên&quot;">​</a></h2><h3 id="_6-1-truy-cap-dataset" tabindex="-1">6.1. Truy Cập Dataset <a class="header-anchor" href="#_6-1-truy-cap-dataset" aria-label="Permalink to &quot;6.1. Truy Cập Dataset&quot;">​</a></h3><p><strong>Phương pháp 1: xView3 Official Portal</strong></p><ol><li>Truy cập <a href="https://iuu.xview.us" target="_blank" rel="noreferrer">https://iuu.xview.us</a></li><li>Tạo account và đăng ký</li><li>Accept terms và data use agreement</li><li>Download data (~1.4 TB total)</li></ol><p><strong>Phương pháp 2: Sentinel-1 Raw Data (cho custom processing)</strong></p><ul><li>Copernicus Data Space: <a href="https://dataspace.copernicus.eu" target="_blank" rel="noreferrer">https://dataspace.copernicus.eu</a></li><li>NASA Earthdata: <a href="https://earthdata.nasa.gov" target="_blank" rel="noreferrer">https://earthdata.nasa.gov</a></li><li>AWS Open Data: <a href="https://registry.opendata.aws/sentinel-1/" target="_blank" rel="noreferrer">https://registry.opendata.aws/sentinel-1/</a></li><li>Google Earth Engine: Programmatic access</li></ul><h3 id="_6-2-data-loading-va-preprocessing" tabindex="-1">6.2. Data Loading và Preprocessing <a class="header-anchor" href="#_6-2-data-loading-va-preprocessing" aria-label="Permalink to &quot;6.2. Data Loading và Preprocessing&quot;">​</a></h3><p><strong>Recommended preprocessing cho SAR:</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rasterio</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> numpy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> load_and_normalize_sar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(scene_id, data_dir):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;Load và normalize SAR data cho training&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Load VV và VH bands</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    vv_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data_dir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scene_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">_vv.tif&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    vh_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data_dir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">scene_id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">_vh.tif&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rasterio.open(vv_path) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> src:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        vv </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> src.read(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).astype(np.float32)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> rasterio.open(vh_path) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> src:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        vh </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> src.read(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).astype(np.float32)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Sigmoid normalization (from 1st place solution)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sigmoid_norm</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, scale</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> /</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.exp(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offset) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> scale))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    vv_norm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sigmoid_norm(vv)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    vh_norm </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sigmoid_norm(vh)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Stack as multi-channel image</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    image </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> np.stack([vv_norm, vh_norm], </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">axis</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> image</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> create_tiles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(image, tile_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, overlap</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;Chia scene lớn thành tiles cho training&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    h, w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> image.shape[:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    stride </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tile_size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> overlap</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    tiles </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, h </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tile_size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, stride):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, w </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tile_size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, stride):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            tile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> image[y:y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tile_size, x:x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tile_size]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            tiles.append({</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &#39;image&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: tile,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                &#39;origin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (x, y)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tiles</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h3 id="_6-3-augmentation-strategies" tabindex="-1">6.3. Augmentation Strategies <a class="header-anchor" href="#_6-3-augmentation-strategies" aria-label="Permalink to &quot;6.3. Augmentation Strategies&quot;">​</a></h3><p><strong>Spatial augmentations (cần cẩn thận với SAR geometry):</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> albumentations </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> A</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">train_transform </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> A.Compose([</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    A.HorizontalFlip(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    A.VerticalFlip(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    A.RandomRotate90(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Careful: Heavy rotation có thể break SAR geometry</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    A.ShiftScaleRotate(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        shift_limit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        scale_limit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        rotate_limit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Limited rotation</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>KHÔNG nên dùng:</strong></p><ul><li>Color augmentation (SAR intensity có physical meaning)</li><li>Strong distortions (có thể break speckle patterns)</li><li>Random erasing (có thể erase targets)</li></ul><h3 id="_6-4-model-training-tips" tabindex="-1">6.4. Model Training Tips <a class="header-anchor" href="#_6-4-model-training-tips" aria-label="Permalink to &quot;6.4. Model Training Tips&quot;">​</a></h3><p><strong>Architecture recommendations:</strong></p><ol><li><strong>U-Net family</strong> với heavy encoder (EfficientNet, ResNet50/101)</li><li><strong>FPN</strong> cho multi-scale detection</li><li><strong>CenterNet/CircleNet</strong> cho point-based detection</li><li><strong>HRNet</strong> cho high-resolution features</li></ol><p><strong>Loss function:</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XView3Loss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Module</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __init__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">__init__</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.detection_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReducedFocalLoss()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.classification_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nn.BCEWithLogitsLoss()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.regression_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nn.SmoothL1Loss()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> forward</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, pred, target):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        det_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.detection_loss(pred[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;heatmap&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], target[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;heatmap&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        cls_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.classification_loss(pred[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;is_vessel&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], target[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;is_vessel&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        fish_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.classification_loss(pred[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;is_fishing&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], target[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;is_fishing&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        len_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.regression_loss(pred[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;length&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], target[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;length&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> det_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cls_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fish_loss </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> len_loss</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>Training settings:</strong></p><ul><li>Batch size: 4-8 (limited by tile size và GPU memory)</li><li>Learning rate: 1e-4 với cosine annealing</li><li>Optimizer: AdamW</li><li>Epochs: 50-100</li><li>Mixed precision training recommended (AMP)</li></ul><h3 id="_6-5-inference-va-post-processing" tabindex="-1">6.5. Inference và Post-Processing <a class="header-anchor" href="#_6-5-inference-va-post-processing" aria-label="Permalink to &quot;6.5. Inference và Post-Processing&quot;">​</a></h3><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inference_full_scene</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model, scene_path, tile_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2048</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, overlap</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Inference trên full scene với tiling và merging</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    image </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> load_and_normalize_sar(scene_path)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    tiles </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> create_tiles(image, tile_size, overlap)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    all_detections </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tiles:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        pred </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> model(tile[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;image&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        detections </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> extract_points_from_heatmap(pred[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;heatmap&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # Convert tile coordinates to scene coordinates</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> det </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> detections:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            det[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;x&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tile[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;origin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            det[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;y&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tile[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;origin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            all_detections.append(det)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Non-maximum suppression để merge overlapping detections</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    final_detections </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nms_points(all_detections, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">radius</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Filter bằng land mask</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    final_detections </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> filter_land(final_detections)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> final_detections</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="_6-6-evaluation-metrics" tabindex="-1">6.6. Evaluation Metrics <a class="header-anchor" href="#_6-6-evaluation-metrics" aria-label="Permalink to &quot;6.6. Evaluation Metrics&quot;">​</a></h3><p><img src="`+y+`" alt="Scoring Components"><em>Breakdown of scoring components in xView3 evaluation metrics</em></p><p><strong>Detection F1 at 200m:</strong></p><div class="language-python vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> calculate_detection_f1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(predictions, ground_truth, distance_threshold</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Calculate F1 with distance-based matching</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    matched_pred </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    matched_gt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i, pred </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(predictions):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j, gt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> enumerate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ground_truth):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> geodesic_distance(pred, gt)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dist </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> distance_threshold </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">not</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> matched_gt:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                matched_pred.add(i)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                matched_gt.add(j)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                break</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    precision </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(matched_pred) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(predictions) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> predictions </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    recall </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(matched_gt) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ground_truth) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ground_truth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    f1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> precision </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> recall </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (precision </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> recall) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (precision </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> recall) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> else</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="_6-7-common-pitfalls" tabindex="-1">6.7. Common Pitfalls <a class="header-anchor" href="#_6-7-common-pitfalls" aria-label="Permalink to &quot;6.7. Common Pitfalls&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Pitfall</th><th>Symptom</th><th>Solution</th></tr></thead><tbody><tr><td>Speckle artifacts</td><td>Many false positives</td><td>Speckle filtering, higher threshold</td></tr><tr><td>Edge effects</td><td>Detections at tile boundaries</td><td>Larger overlap, NMS post-processing</td></tr><tr><td>Land detections</td><td>False positives on coast</td><td>Use land/ice mask</td></tr><tr><td>Missing small vessels</td><td>Low recall</td><td>Multi-scale approach, lower threshold</td></tr><tr><td>Overfitting</td><td>Good on train, bad on test</td><td>More augmentation, regularization</td></tr></tbody></table><h3 id="_6-8-tai-nguyen-chinh-thuc" tabindex="-1">6.8. Tài Nguyên Chính Thức <a class="header-anchor" href="#_6-8-tai-nguyen-chinh-thuc" aria-label="Permalink to &quot;6.8. Tài Nguyên Chính Thức&quot;">​</a></h3><p><strong>Websites:</strong></p><ul><li>xView3 Challenge: <a href="https://iuu.xview.us" target="_blank" rel="noreferrer">https://iuu.xview.us</a></li><li>Global Fishing Watch: <a href="https://globalfishingwatch.org" target="_blank" rel="noreferrer">https://globalfishingwatch.org</a></li><li>DIU xView Series: <a href="https://www.diu.mil/ai-xview-challenge" target="_blank" rel="noreferrer">https://www.diu.mil/ai-xview-challenge</a></li></ul><p><strong>Papers:</strong></p><ul><li><a href="https://arxiv.org/abs/2206.00897" target="_blank" rel="noreferrer">xView3-SAR (NeurIPS 2022)</a></li><li><a href="https://www.mdpi.com/2072-4292/11/24/2997" target="_blank" rel="noreferrer">Sentinel-1 SAR Ship Detection Review</a></li></ul><p><strong>GitHub Repositories:</strong></p><ul><li><a href="https://github.com/DIUx-xView/xview3-reference" target="_blank" rel="noreferrer">xView3 Reference Code</a></li><li><a href="https://github.com/BloodAxe/xView3-The-First-Place-Solution" target="_blank" rel="noreferrer">1st Place Solution</a></li><li><a href="https://github.com/allenai/sar_vessel_detect" target="_blank" rel="noreferrer">AI2 Skylight Solution</a></li></ul><p><strong>Sentinel-1 Resources:</strong></p><ul><li><a href="https://dataspace.copernicus.eu" target="_blank" rel="noreferrer">Copernicus Data Space</a></li><li><a href="https://step.esa.int/main/toolboxes/snap/" target="_blank" rel="noreferrer">ESA SNAP Toolbox</a></li><li><a href="https://sentinels.copernicus.eu/web/sentinel/user-guides/sentinel-1-sar" target="_blank" rel="noreferrer">Sentinel-1 User Guide</a></li></ul><h3 id="_6-9-citation" tabindex="-1">6.9. Citation <a class="header-anchor" href="#_6-9-citation" aria-label="Permalink to &quot;6.9. Citation&quot;">​</a></h3><div class="language-bibtex vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bibtex</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@inproceedings</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">paolo2022xview3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  title</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">xView3-SAR: Detecting Dark Fishing Activity Using</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">         Synthetic Aperture Radar Imagery</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  author</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Paolo, Fernando S and Kroodsma, David A and Raber, Jaeyoon</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          and Aoki, Nate and Sawyer, Timothy and Malins, Pete and Bosch,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          Jared and Southworth, Jesse and Prichard, Brian and others</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  booktitle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Thirty-sixth Conference on Neural Information Processing</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">             Systems Datasets and Benchmarks Track</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  year</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">2022</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr><h2 id="phu-luc" tabindex="-1">Phụ Lục <a class="header-anchor" href="#phu-luc" aria-label="Permalink to &quot;Phụ Lục&quot;">​</a></h2><h3 id="a-sentinel-1-technical-specifications" tabindex="-1">A. Sentinel-1 Technical Specifications <a class="header-anchor" href="#a-sentinel-1-technical-specifications" aria-label="Permalink to &quot;A. Sentinel-1 Technical Specifications&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Parameter</th><th>Value</th></tr></thead><tbody><tr><td>Launch dates</td><td>S1A: April 2014, S1B: April 2016</td></tr><tr><td>Orbit altitude</td><td>693 km</td></tr><tr><td>Inclination</td><td>98.18° (sun-synchronous)</td></tr><tr><td>Repeat cycle</td><td>12 days (6 days with constellation)</td></tr><tr><td>Radar frequency</td><td>5.405 GHz (C-band)</td></tr><tr><td>Wavelength</td><td>5.55 cm</td></tr><tr><td>Polarization modes</td><td>HH+HV, VV+VH, HH, VV</td></tr><tr><td>IW mode swath</td><td>250 km</td></tr><tr><td>IW mode resolution</td><td>5m × 20m (single look), 20m × 22m (GRD)</td></tr><tr><td>SM mode swath</td><td>80 km</td></tr><tr><td>SM mode resolution</td><td>1.7m × 4.3m (single look)</td></tr></tbody></table><h3 id="b-performance-comparison-baseline-vs-top-solutions" tabindex="-1">B. Performance Comparison: Baseline vs Top Solutions <a class="header-anchor" href="#b-performance-comparison-baseline-vs-top-solutions" aria-label="Permalink to &quot;B. Performance Comparison: Baseline vs Top Solutions&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Metric</th><th>Baseline</th><th>1st Place</th><th>2nd Place</th><th>3rd Place</th></tr></thead><tbody><tr><td>Detection F1</td><td>0.35</td><td>0.78</td><td>0.75</td><td>0.72</td></tr><tr><td>Vessel F1</td><td>0.45</td><td>0.85</td><td>0.82</td><td>0.80</td></tr><tr><td>Fishing F1</td><td>0.30</td><td>0.65</td><td>0.62</td><td>0.60</td></tr><tr><td>Length MAE (m)</td><td>45</td><td>18</td><td>20</td><td>22</td></tr><tr><td>Overall Score</td><td>0.28</td><td>0.72</td><td>0.69</td><td>0.67</td></tr></tbody></table><h3 id="c-hardware-requirements" tabindex="-1">C. Hardware Requirements <a class="header-anchor" href="#c-hardware-requirements" aria-label="Permalink to &quot;C. Hardware Requirements&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Component</th><th>Minimum</th><th>Recommended</th></tr></thead><tbody><tr><td>GPU</td><td>RTX 2080 (8GB)</td><td>A100 (40GB) or 4× RTX 3090</td></tr><tr><td>RAM</td><td>32 GB</td><td>128 GB</td></tr><tr><td>Storage</td><td>2 TB SSD</td><td>4 TB NVMe RAID</td></tr><tr><td>CPU</td><td>8 cores</td><td>32+ cores</td></tr></tbody></table><p><strong>Lưu ý:</strong> Due to large tile sizes và full-scene inference, xView3 training/inference yêu cầu hardware mạnh hơn đáng kể so với xView1/xView2.</p><h3 id="d-iuu-fishing-impact-statistics" tabindex="-1">D. IUU Fishing Impact Statistics <a class="header-anchor" href="#d-iuu-fishing-impact-statistics" aria-label="Permalink to &quot;D. IUU Fishing Impact Statistics&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Statistic</th><th>Value</th></tr></thead><tbody><tr><td>Annual economic loss</td><td>$10-23 billion USD</td></tr><tr><td>Percentage of global catch</td><td>20-30%</td></tr><tr><td>Most affected regions</td><td>West Africa, Southeast Asia</td></tr><tr><td>Labor violations linked</td><td>47% of IUU vessels</td></tr><tr><td>Species at risk</td><td>85+ commercially important species</td></tr></tbody></table><hr><p><em>Tài liệu tạo: 2024-12-18</em><em>Cập nhật lần cuối: 2025-12-19</em><em>Số từ: ~7,800</em></p>`,141))])}const T=r(m,[["render",F]]);export{w as __pageData,T as default};
