<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 500">
  <defs>
    <linearGradient id="encoderGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1d4ed8;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="decoderGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="headGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f59e0b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#d97706;stop-opacity:1" />
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="900" height="500" fill="#f8fafc"/>

  <!-- Title -->
  <text x="450" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1e293b">CircleNet Architecture</text>

  <!-- Input Section -->
  <rect x="30" y="180" width="100" height="140" rx="8" fill="#e2e8f0" stroke="#94a3b8" stroke-width="2"/>
  <text x="80" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#334155">SAR Input</text>
  <text x="80" y="230" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">2048x2048x4</text>
  <line x1="50" y1="245" x2="110" y2="245" stroke="#94a3b8" stroke-width="1"/>
  <text x="80" y="262" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#475569">VH</text>
  <text x="80" y="277" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#475569">VV</text>
  <text x="80" y="292" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#475569">Bathymetry</text>
  <text x="80" y="307" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#475569">Wind</text>

  <!-- Encoder -->
  <g>
    <rect x="160" y="70" width="280" height="360" rx="10" fill="none" stroke="#3b82f6" stroke-width="2" stroke-dasharray="5,5"/>
    <text x="300" y="95" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1d4ed8">EfficientNet Encoder</text>

    <!-- Encoder stages -->
    <rect x="180" y="115" width="240" height="40" rx="6" fill="url(#encoderGrad)"/>
    <text x="300" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Stage 1: 512x512x32</text>

    <rect x="195" y="165" width="210" height="40" rx="6" fill="url(#encoderGrad)"/>
    <text x="300" y="190" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Stage 2: 256x256x48</text>

    <rect x="210" y="215" width="180" height="40" rx="6" fill="url(#encoderGrad)"/>
    <text x="300" y="240" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Stage 3: 128x128x80</text>

    <rect x="225" y="265" width="150" height="40" rx="6" fill="url(#encoderGrad)"/>
    <text x="300" y="290" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Stage 4: 64x64x160</text>

    <rect x="240" y="315" width="120" height="40" rx="6" fill="url(#encoderGrad)"/>
    <text x="300" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Stage 5: 32x32x272</text>

    <!-- Down arrows (drawn directly) -->
    <polygon points="300,155 295,162 300,159 305,162" fill="#64748b"/>
    <polygon points="300,205 295,212 300,209 305,212" fill="#64748b"/>
    <polygon points="300,255 295,262 300,259 305,262" fill="#64748b"/>
    <polygon points="300,305 295,312 300,309 305,312" fill="#64748b"/>
  </g>

  <!-- Decoder -->
  <g>
    <rect x="460" y="70" width="220" height="360" rx="10" fill="none" stroke="#10b981" stroke-width="2" stroke-dasharray="5,5"/>
    <text x="570" y="95" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#059669">U-Net Decoder</text>

    <!-- Decoder stages -->
    <rect x="525" y="315" width="90" height="35" rx="6" fill="url(#decoderGrad)"/>
    <text x="570" y="337" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">32-64</text>

    <rect x="510" y="265" width="120" height="35" rx="6" fill="url(#decoderGrad)"/>
    <text x="570" y="287" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">64-128</text>

    <rect x="495" y="215" width="150" height="35" rx="6" fill="url(#decoderGrad)"/>
    <text x="570" y="237" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">128-256</text>

    <rect x="480" y="165" width="180" height="35" rx="6" fill="url(#decoderGrad)"/>
    <text x="570" y="187" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">256-512</text>

    <rect x="480" y="115" width="180" height="35" rx="6" fill="#8b5cf6"/>
    <text x="570" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">PixelShuffle</text>
    <text x="570" y="143" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">512-1024-2048</text>

    <!-- Up arrows (drawn directly) -->
    <polygon points="570,315 565,308 570,311 575,308" fill="#64748b"/>
    <polygon points="570,265 565,258 570,261 575,258" fill="#64748b"/>
    <polygon points="570,215 565,208 570,211 575,208" fill="#64748b"/>
    <polygon points="570,165 565,158 570,161 575,158" fill="#64748b"/>

    <!-- Skip connections -->
    <path d="M420 135 C450 135, 450 135, 478 135" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4,2" fill="none"/>
    <path d="M405 185 C440 185, 440 185, 478 185" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4,2" fill="none"/>
    <path d="M390 235 C430 235, 430 235, 493 235" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4,2" fill="none"/>
    <path d="M375 285 C420 285, 420 285, 508 285" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4,2" fill="none"/>
    <text x="448" y="398" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#94a3b8">Skip Connections</text>
  </g>

  <!-- Arrow from input to encoder -->
  <line x1="130" y1="250" x2="155" y2="250" stroke="#64748b" stroke-width="2"/>
  <polygon points="158,250 151,246 151,254" fill="#64748b"/>

  <!-- Arrow from encoder to decoder -->
  <line x1="360" y1="335" x2="520" y2="335" stroke="#64748b" stroke-width="2"/>
  <polygon points="523,335 516,331 516,339" fill="#64748b"/>

  <!-- Task Heads -->
  <g>
    <rect x="700" y="70" width="180" height="360" rx="10" fill="none" stroke="#f59e0b" stroke-width="2" stroke-dasharray="5,5"/>
    <text x="790" y="95" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#d97706">Task Heads</text>

    <rect x="720" y="115" width="140" height="60" rx="6" fill="url(#headGrad)"/>
    <text x="790" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">Objectness</text>
    <text x="790" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Heatmap (Focal Loss)</text>
    <text x="790" y="168" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">2048x2048x1</text>

    <rect x="720" y="185" width="140" height="60" rx="6" fill="url(#headGrad)"/>
    <text x="790" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">Is Vessel</text>
    <text x="790" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Classification (BCE)</text>
    <text x="790" y="238" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">2048x2048x1</text>

    <rect x="720" y="255" width="140" height="60" rx="6" fill="url(#headGrad)"/>
    <text x="790" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">Is Fishing</text>
    <text x="790" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Classification (BCE)</text>
    <text x="790" y="308" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">2048x2048x1</text>

    <rect x="720" y="325" width="140" height="60" rx="6" fill="url(#headGrad)"/>
    <text x="790" y="350" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">Length</text>
    <text x="790" y="365" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">Regression (L1)</text>
    <text x="790" y="378" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="white">2048x2048x1</text>
  </g>

  <!-- Arrows from decoder to heads -->
  <line x1="660" y1="135" x2="715" y2="145" stroke="#64748b" stroke-width="2"/>
  <polygon points="718,145 710,143 712,150" fill="#64748b"/>

  <line x1="660" y1="135" x2="715" y2="215" stroke="#64748b" stroke-width="2"/>
  <polygon points="718,216 711,211 710,219" fill="#64748b"/>

  <line x1="660" y1="135" x2="715" y2="285" stroke="#64748b" stroke-width="2"/>
  <polygon points="718,286 711,280 710,288" fill="#64748b"/>

  <line x1="660" y1="135" x2="715" y2="355" stroke="#64748b" stroke-width="2"/>
  <polygon points="718,356 711,350 710,358" fill="#64748b"/>

  <!-- Legend -->
  <rect x="30" y="440" width="840" height="50" rx="6" fill="#f1f5f9" stroke="#e2e8f0"/>
  <text x="50" y="460" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#334155">Key Innovation:</text>
  <text x="50" y="478" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Stride-2 output (vs stride-16 traditional) = 8x higher localization precision for small vessel detection</text>
  <rect x="550" y="450" width="12" height="12" fill="#8b5cf6"/>
  <text x="570" y="460" font-family="Arial, sans-serif" font-size="9" fill="#64748b">PixelShuffle upsampling</text>
  <line x1="700" y1="456" x2="730" y2="456" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4,2"/>
  <text x="740" y="460" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Skip connections</text>
</svg>
